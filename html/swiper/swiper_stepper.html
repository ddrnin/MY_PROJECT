<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=no , viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="format-detection" content="telephone=no">
    <meta name="view-transition" content="same-origin">
    <title>ddrnin | swiper_stepper</title>

    <!-- Social Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:title" content="@@title ddrnin">
    <meta property="og:image" content="">
    <meta property="og:description" content="">
    <meta property="og:site_name" content="">

    <!-- css -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/font.css">
    <link rel="stylesheet" href="/assets/css/plugin/swiper-bundle.min.css">

    <!-- js -->
    <script src="/assets/js/plugin/jquery-3.7.0.min.js"></script><!-- jQuery 3.7.0 -->
    <script src="/assets/js/ui.common.min.js"></script><!-- 퍼블리싱용 js -->
    <script src="/assets/js/plugin/swiper-bundle.min.js"></script><!-- 스와이퍼 -->
    <!-- gsap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.1/ScrollToPlugin.min.js"></script>
    <!-- 렌니스 -->
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1/bundled/lenis.min.js"></script>
    <!-- aos -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
</head>

<body>
    <header>
        <div class="header_wrap">

            <h1 class="header_title">swiper_stepper</h1>

            <!-- 헤더 인클루드 -->
        </div>
    </header>
    <main class="layoutM">
        <section class="swiper_stepper">
            <div class="dosirak_area">
                <ul class="dosirak">
                    <li>밥</li>
                    <li>메반1</li>
                    <li>메반2</li>
                    <li>메반3</li>
                    <li>서반1</li>
                    <li>서반2</li>
                    <li>채김1</li>
                    <li>채김2</li>
                </ul>
            </div>
            <div class="swiper stepper_swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide step01">
                        <ul>
                            <li class="bap01">
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>밥1</div>
                                </label>
                            </li>
                            <li class="bap02">
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>밥1</div>
                                </label>
                            </li>
                            <li class="bap02">
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>밥1</div>
                                </label>
                            </li>
                            <li class="bap01">
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>밥1</div>
                                </label>
                            </li>
                            <li class="bap01">
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>밥1</div>
                                </label>
                            </li>
                            <li class="bap08">
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>밥1</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step02">
                        <ul>
                            <li class="meban01">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>메인반찬</div>
                                </label>
                            </li>
                            <li class="meban01">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>메인반찬</div>
                                </label>
                            </li>
                            <li class="meban01">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>메인반찬</div>
                                </label>
                            </li>
                            <li class="meban01">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>메인반찬</div>
                                </label>
                            </li>
                            <li class="meban05">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>메인반찬</div>
                                </label>
                            </li>
                            <li class="meban08">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>소 불고기</div>
                                </label>
                            </li>
                            <li class="meban010">
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>간장 돼지 불고기</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>떡갈비</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>닭강정</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>고등어구이</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>언양식 바싹 불고기</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>부대볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>새우튀김</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>고추장 닭갈비</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>간장찜닭</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>함박스테이크</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step03">
                        <ul>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>서브반찬</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>서브반찬</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>서브반찬</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>서브반찬</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>서브반찬</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>서브반찬</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step04">
                        <ul>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>채소/김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>채소/김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>채소/김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>채소/김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>채소/김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>채소/김치</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step05">
                        <div>완성</div>
                        <div class="dosirak_area">
                            <ul class="dosirak">
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                                <li><img src="" alt=""></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-pagination"></div>
            </div>
        </section>
    </main>
</body>
<script>
    var swiper = new Swiper(".stepper_swiper", {
        touchRatio: 0,
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        pagination: {
            el: ".swiper-pagination",
            type: 'bullets',
        },
        on: {
            slideChange: function() {
                // 현재 활성화된 인덱스 가져오기
                var activeIndex = swiper.activeIndex;
                var previousIndex = swiper.previousIndex;
                // 모든 bullet 가져오기
                var bullets = document.querySelectorAll('.swiper-pagination-bullet');

                // 현재 인덱스 이전의 모든 bullet에 active 클래스 추가
                if (activeIndex > previousIndex) {
                    bullets.forEach(function(bullet, index) {
                        if (index <= activeIndex) {
                            bullet.classList.add('active');
                        }
                    });
                }
                // 뒤로 이동한 경우, 현재 인덱스 이후의 모든 bullet에서 active 클래스 제거
                if (activeIndex < previousIndex) {
                    bullets.forEach(function(bullet, index) {
                        if (index > activeIndex) {
                            bullet.classList.remove('active');
                        }
                    });
                }
            }
        },
    });

    // function activeButton() {
    // 	// step01
    // 	if($('.swiper-pagination-bullet:nth-child(1)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step01 input[type="checkbox"]:checked').length > 0) {
    // 			$('.step01 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step01 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	}
    // 	// step02
    // 	if($('.swiper-pagination-bullet:nth-child(2)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step02 input[type="checkbox"]:checked').length >= 3) {
    // 			$('.step02 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step02 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	} 
    // 	// step03
    // 	if($('.swiper-pagination-bullet:nth-child(3)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step03 input[type="checkbox"]:checked').length >= 2) {
    // 			$('.step03 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step03 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	} 
    // 	// step04
    // 	if($('.swiper-pagination-bullet:nth-child(4)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step04 input[type="checkbox"]:checked').length >= 2) {
    // 			$('.step04 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step04 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	} 

    // }
    // $('.step01').on('change', 'input[type="checkbox"]', activeButton(i))
    // $('.step02').on('change', 'input[type="checkbox"]', activeButton)
    // $('.step03').on('change', 'input[type="checkbox"]', activeButton)
    // $('.step04').on('change', 'input[type="checkbox"]', activeButton)
    // $('.swiper-button-next, .swiper-button-prev').on('click', activeButton)

    // step별 체크 갯수
    const minChecked = {
        1: 1,
        2: 3,
        3: 2,
        4: 2
    }

    function activeButton(step) {

        if ($(`.swiper-pagination-bullet:nth-child(${step})`).hasClass('swiper-pagination-bullet-active')) {
            $('.swiper-button-next').removeClass('on');

            const stepSelector = `.step0${step}`;
            const checkedLength = $(`${stepSelector} input[type="checkbox"]:checked`).length;
            if (checkedLength >= minChecked[step]) {
                $(`${stepSelector} input[type="checkbox"]`).not(':checked').attr('disabled', true);
                $('.swiper-button-next').addClass('on');
            } else {
                $(`${stepSelector} input[type="checkbox"]`).removeAttr('disabled');
            }
        }
    }

    function toastPop(step) {
        // 스텝이 맞는 토스트팝 함수 만들고 넥스트 버튼 눌렀을때 페이지네이션 active로 페이지 판별해서 띄우기
    }

    // function updateDosirakImage(step) {
    // 	// 각 스텝별로 처리
    // 	$(`.step0${step} li input[type="checkbox"]`).on('change', function() {
    // 		// 체크된 체크박스의 부모 li 인덱스를 가져오기
    // 		let checkedIndex = $(this).closest('li').index() + 1;
    // 		// 각 스텝에 맞는 이미지 경로 설정
    // 		let imgSrc;
    // 		if (step === 1) {
    // 			if (this.checked) {
    // 				imgSrc = `../../../assets/img/bap0${checkedIndex}.png`;
    // 			} else {
    // 				imgSrc = '';
    // 			}
    // 			$(`.dosirak li:nth-child(1) img`).attr('src', imgSrc); // 첫 번째 li에 이미지 변경
    // 		} else if (step === 2) {
    // 			if (this.checked) {
    // 				imgSrc = `../../../assets/img/meban0${checkedIndex}.png`;

    // 				if (!$('.dosirak li:nth-child(2) img').attr('src')) {
    // 					$('.dosirak li:nth-child(2) img').attr('src', imgSrc);
    // 				} else if (!$('.dosirak li:nth-child(3) img').attr('src')) {
    // 					$('.dosirak li:nth-child(3) img').attr('src', imgSrc);
    // 				} else if (!$('.dosirak li:nth-child(4) img').attr('src')) {
    // 					$('.dosirak li:nth-child(4) img').attr('src', imgSrc);
    // 				}
    // 			} else {
    // 				// 뒤에서부터 순차적으로 이미지 제거 (4 -> 3 -> 2 번째 li)
    // 				if ($('.dosirak li:nth-child(4) img').attr('src') === `../../../assets/img/meban0${checkedIndex}.png`) {
    // 					$(`.dosirak li:nth-child(4) img`).attr('src', '');
    // 				} else if ($('.dosirak li:nth-child(3) img').attr('src') === `../../../assets/img/meban0${checkedIndex}.png`) {
    // 					$(`.dosirak li:nth-child(3) img`).attr('src', '');
    // 				} else if ($('.dosirak li:nth-child(2) img').attr('src') === `../../../assets/img/meban0${checkedIndex}.png`) {
    // 					$(`.dosirak li:nth-child(2) img`).attr('src', '');
    // 				}
    // 			}
    // 		} else if (step === 3) {
    // 			if (this.checked) {
    // 				imgSrc = `../../../assets/img/suban0${checkedIndex}.png`;

    // 				if (!$('.dosirak li:nth-child(5) img').attr('src')) {
    // 					$('.dosirak li:nth-child(5) img').attr('src', imgSrc);
    // 				} else if (!$('.dosirak li:nth-child(6) img').attr('src')) {
    // 					$('.dosirak li:nth-child(6) img').attr('src', imgSrc);
    // 				}
    // 			} else {
    // 				if ($(`.dosirak li:nth-child(6) img`).attr('src') === `../../../assets/img/suban0${checkedIndex}.png`) {
    // 					$(`.dosirak li:nth-child(6) img`).attr('src', '');
    // 				} else if ($(`.dosirak li:nth-child(5) img`).attr('src') === `../../../assets/img/suban0${checkedIndex}.png`) {
    // 					$(`.dosirak li:nth-child(5) img`).attr('src', '');
    // 				}
    // 			}
    // 		} else if (step === 4) {
    // 			if(this.checked) {
    // 				imgSrc = `../../../assets/img/kimchi0${checkedIndex}.png`;

    // 				if (!$('.dosirak li:nth-child(7) img').attr('src')) {
    // 					$('.dosirak li:nth-child(7) img').attr('src', imgSrc);
    // 				} else if (!$('.dosirak li:nth-child(8) img').attr('src')) {
    // 					$('.dosirak li:nth-child(8) img').attr('src', imgSrc);
    // 				}
    // 			} else {
    // 				if ($('.dosirak li:nth-child(8) img').attr('src') === `../../../assets/img/kimchi0${checkedIndex}.png`) {
    // 					$('.dosirak li:nth-child(8) img').attr('src', '');
    // 				} else if ($('.dosirak li:nth-child(7) img').attr('src') === `../../../assets/img/kimchi0${checkedIndex}.png`) {
    // 					$('.dosirak li:nth-child(7) img').attr('src', '');
    // 				}
    // 			}
    // 		}
    // 	});
    // }
    function updateDosirakImage(step) {
        const imgTypes = ['bap', 'meban', 'suban', 'kimchi']; // 각 스텝에 해당하는 이미지 타입
        const maxImgs = [1, 3, 2, 2]; // 각 스텝별로 img가 들어가는 li 개수

        $(`.step0${step} li input[type="checkbox"]`).on('change', function() {
            // 체크된 체크박스의 li 요소의 클래스명에서 필요한 정보 추출
            const liClass = $(this).closest('li').attr('class'); // li의 클래스명 가져오기
            const imgTypeMatch = liClass.match(/(bap|meban|suban|kimchi)(\d+)/); // 클래스명에서 타입과 숫자 추출

            if (imgTypeMatch) {
                const imgType = imgTypeMatch[1]; // bap, meban, suban, kimchi 중 하나
                const checkedIndex = imgTypeMatch[2]; // 숫자 추출 (1, 2, 3 등)

                const imgSrc = `../../../assets/img/${imgType}${checkedIndex}.png`;

                // 스텝별로 이미지 갯수만큼 처리
                const startIdx = maxImgs.slice(0, step - 1).reduce((a, b) => a + b, 1); // 해당 스텝의 시작 li 인덱스 계산
                const endIdx = startIdx + maxImgs[step - 1] - 1; // 해당 스텝의 마지막 li 인덱스 계산

                if (this.checked) {
                    // 체크되었을 때: 빈 img를 찾아 이미지 삽입
                    for (let i = startIdx; i <= endIdx; i++) {
                        let liImg = $(`.dosirak li:nth-child(${i}) img`);
                        if (!liImg.attr('src')) {
                            liImg.attr('src', imgSrc);
                            break;
                        }
                    }
                } else {
                    // 체크 해제되었을 때: 이미지 src를 찾아서 제거
                    for (let i = endIdx; i >= startIdx; i--) { // 뒤에서부터 제거
                        let liImg = $(`.dosirak li:nth-child(${i}) img`);
                        if (liImg.attr('src') === imgSrc) {
                            liImg.attr('src', '');
                            break;
                        }
                    }
                }
            }
        });
    }
    // 스텝별 checkbox 변화에 따라 갱신
    for (let i = 1; i <= 4; i++) {
        $(`.step0${i}`).on('change', 'input[type="checkbox"]', function() {
            activeButton(i);
        });
    }
    // swiper 버튼 클릭 시 상태 갱신
    $('.swiper-button-next, .swiper-button-prev').on('click', function() {
        for (let i = 1; i <= 4; i++) {
            activeButton(i);
        }
    });






    // 이전 버튼 클릭 시 다음 버튼 활성화
    // $('.swiper-button-prev').on('click', function() {
    // 	$('.swiper-button-next').removeClass('off');
    // });
    //  // 다음 버튼 클릭 시 다음 버튼 비활성화
    // $('.swiper-button-next').on('click', function() {
    // 	$(this).addClass('off')
    // });
    // 스텝02 체크박스 갯수 제한
    // $('.step02').on('change', 'input[type="checkbox"]', function() {
    // 	if ($('.step02 input[type="checkbox"]:checked').length >= 3) {
    // 		$('.step02 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 		// 선택 갯수 충족 시 다음 버튼 활성화
    // 		$('.swiper-button-next').removeClass('off');
    // 	} else {
    // 		$('.step02 input[type="checkbox"]').removeAttr('disabled');
    // 		$('.swiper-button-next').addClass('off');
    // 	}
    // });
    // 스텝03 체크박스 갯수 제한
    // $('.step03').on('change', 'input[type="checkbox"]', function() {
    // 	if ($('.step03 input[type="checkbox"]:checked').length >= 2) {
    // 		$('.step03 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 		$('.swiper-button-next').removeClass('off');
    // 	} else {
    // 		$('.step03 input[type="checkbox"]').removeAttr('disabled');
    // 		$('.swiper-button-next').addClass('off');
    // 	}
    // });
    // 스텝04 체크박스 갯수 제한
    // $('.step04').on('change', 'input[type="checkbox"]', function() {
    // 	if ($('.step04 input[type="checkbox"]:checked').length >= 2) {
    // 		$('.step04 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 		$('.swiper-button-next').removeClass('off');
    // 	} else {
    // 		$('.step04 input[type="checkbox"]').removeAttr('disabled');
    // 		$('.swiper-button-next').addClass('off');
    // 	}
    // });
</script>

<!-- <script>
	// 페이지 로드시 선택지 섞기
	function shuffleStep(step) {
		const stepUl = $(`.step0${step} ul`);
		const lis = stepUl.children('li').get();

		lis.sort(() => 0.5 - Math.random());

		$.each(lis, function(index, li) {
			stepUl.append(li);
		});
	}
	$(document).ready(function(){
		for(i=1; i<=4; i++){
			shuffleStep(i);
		}
	})

	// 프로젝트7 스와이퍼
	var swiper = new Swiper(".dosirak_swiper", {
		touchRatio: 0,
		speed: 500,
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev',
		},
		pagination: {
			el: ".swiper-pagination",
			type: 'bullets',
		},
		on: {
			slideChange: function () {
				var activeIndex = swiper.activeIndex;
				var previousIndex = swiper.previousIndex;
				var bullets = document.querySelectorAll('.swiper-pagination-bullet');
				
				// 현재 인덱스 이전의 모든 bullet에 active 클래스 추가
				if (activeIndex > previousIndex) {
					bullets.forEach(function (bullet, index) {
						if (index <= activeIndex) {
							bullet.classList.add('active');
						}
					});
				}
				// 뒤로 이동한 경우, 현재 인덱스 이후의 모든 bullet에서 active 클래스 제거
				if (activeIndex < previousIndex) {
					bullets.forEach(function (bullet, index) {
						if (index > activeIndex) {
							bullet.classList.remove('active');
						}
					});
				}
			}
		},
	});

	
	// 다음 버튼 활성화
	function activeButton(step) {
		// step별 필요 선택 갯수
		const minChecked = {
			1: 1,
			2: 3,
			3: 2,
			4: 2
		}
		// 페이지네이션 불렛으로 각 스텝에 맞게 체크
		if ($(`.project7 .swiper-pagination-bullet:nth-child(${step})`).hasClass('swiper-pagination-bullet-active')) {
			$('.project7 .swiper-button-next').removeClass('on');
			const stepSelector = `.step0${step}`;
			const checkedLength = $(`${stepSelector} input[type="checkbox"]:checked`).length;
			// 각 step별 필요 갯수 확인 후 다음 버튼 활성화, 체크 박스 비활성화
			if (checkedLength >= minChecked[step]) {
				$(`${stepSelector} input[type="checkbox"]`).not(':checked').attr('disabled', true);
				$('.project7 .swiper-button-next').addClass('on');
			} else {
				$(`${stepSelector} input[type="checkbox"]`).removeAttr('disabled');
			}
		}
	}

	// 선택 시 도시락 트레이 이미지 업데이트
	function updateImage(step) {
		const imgTypes = ['bap', 'main', 'sub', 'kimchi'];
		const maxImgs = [1, 3, 2, 2]
		
		$(`.step0${step} li input[type="checkbox"]`).on('change', function() {
			const liClass = $(this).closest('li').attr('class'); // li의 클래스명 가져오기
			const imgTypeMatch = liClass.match(/(bap|main|sub|kimchi)(\d+)/); // 클래스명에서 타입과 숫자 추출
			if (imgTypeMatch) {
				const imgType = imgTypeMatch[1]; // 추출한 타입
				const checkedIndex = imgTypeMatch[2]; // 추출한 숫자

				const imgSrc = `./img/${imgType}${checkedIndex}.png`; // 이미지 경로 설정

				// 스텝별로 이미지 갯수만큼 처리
				const startIdx = maxImgs.slice(0, step - 1).reduce((a, b) => a + b, 1); // 해당 스텝의 시작 li 인덱스 계산
				const endIdx = startIdx + maxImgs[step - 1] - 1; // 해당 스텝의 마지막 li 인덱스 계산

				if (this.checked) {
					// 빈 img요소 찾아 이미지 삽입
					for (let i = startIdx; i <= endIdx; i++) {
						let liImg = $(`.dosirak li:nth-child(${i}) img`);
						if (!liImg.attr('src')) {
							liImg.attr('src', imgSrc);
							break;
						}
					}
				} else {
					// 이미지 src를 찾아서 제거
					for (let i = endIdx; i >= startIdx; i--) {
						let liImg = $(`.dosirak li:nth-child(${i}) img`);
						if (liImg.attr('src') === imgSrc) {
							liImg.attr('src', '');
							break;
						}
					}
				}
			}
		});
	}

	// 랜덤 토스트 팝업
	function toastPop(step) {
		var randomPop;
		if (step <= 3) {
			randomPop = Math.random() < 0.5 ? '.toast_pop.pop01' : '.toast_pop.pop02';
		} else if (step > 3) {
			randomPop = Math.random() < 0.5 ? '.toast_pop.pop03' : '.toast_pop.pop04';
		}
		$(randomPop).addClass('active');
		setTimeout(function(){
			$(randomPop).removeClass('active');
		}, 1000)
	}
	$('.swiper-button-next').on('click', function() {
		const currentStep = swiper.activeIndex + 1;
		toastPop(currentStep);
	});

	// 결과 페이지
	function resultPage(step) {
		$(`.step0${step} li input[type="checkbox"]`).on('change', function() {
			const checkedText = $(this).closest('li').find('.name').text();
			const resultContainer = $(`.step0${step}_result .list_wrap`);

			if (this.checked) {
				resultContainer.append(`<p>${checkedText}</p>`);
			} else {
				resultContainer.find(`p:contains('${checkedText}')`).remove();
			}
		})
	} 
	
	// 스텝별 checkbox 변화에 따라 갱신
	for (let i = 1; i <= 4; i++) {
		updateImage(i);
		resultPage(i);
		$(`.step0${i}`).on('change', 'input[type="checkbox"]', function() {
			activeButton(i);
		});
	}
	// swiper 이전, 다음 버튼 클릭 시 모든 step 상태 갱신
	$('.project7 .swiper-button-next, .swiper-button-prev').on('click', function() {
		for (let i = 1; i <= 4; i++) {
			activeButton(i);
		}
	});
	$('.project7 .swiper-button-next').on('click', function() {
		const currentStep = swiper.activeIndex + 1;
		toastPop(currentStep)
	})

	var scrollPosition = 0;
		
	//스크롤 잠금
	function isLocked() {
		var $body = $("body");

		scrollPosition = window.pageYOffset;
		$body.css({"position":"fixed","top":-scrollPosition+"px"});
	}

	//스크롤 잠금 해제
	function isUnLocked() {
		var $body = $("body");

		$body.css({"position":"","top":""});
		window.scrollTo(0, scrollPosition);
	}
		
	//프로젝트 팝업
	$(".btn_project7").click(function() {
		$("body").addClass("fixed");
		$("body").append("<div class='dimed'></div>");
		$(".alert_project7_pop").slideDown(500);
		isLocked();
	});

	//팝업 닫기
	function closePopup() {
		$("body").removeClass("fixed");
		$(".dimed").fadeOut(300, function() {
			$(this).remove();
		});
		$(".alert_pop").slideUp(400);
		isUnLocked();
	}

	$(".btn_wrap_flx .btn").click(closePopup);
</script> -->

</html>