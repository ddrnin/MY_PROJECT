<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=no , viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="format-detection" content="telephone=no">
    <meta name="view-transition" content="same-origin">
    <title>ddrnin | swiper_stepper</title>

    <!-- Social Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:title" content="@@title ddrnin">
    <meta property="og:image" content="">
    <meta property="og:description" content="">
    <meta property="og:site_name" content="">

    <!-- css -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/font.css">
    <link rel="stylesheet" href="/assets/css/plugin/swiper-bundle.min.css">

    <!-- js -->
    <script src="/assets/js/plugin/jquery-3.7.0.min.js"></script><!-- jQuery 3.7.0 -->
    <script src="/assets/js/ui.common.min.js"></script><!-- 퍼블리싱용 js -->
    <script src="/assets/js/plugin/swiper-bundle.min.js"></script><!-- 스와이퍼 -->
    <!-- gsap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.1/ScrollToPlugin.min.js"></script>
    <!-- 렌니스 -->
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1/bundled/lenis.min.js"></script>
    <!-- aos -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
</head>

<body>
    <header>
        <div class="header_wrap">

            <h1 class="header_title">swiper_stepper</h1>

            <!-- 헤더 인클루드 -->
        </div>
    </header>
    <main class="layoutM">
        <section class="swiper_stepper">
            <div class="dosirak_area">
                <ul class="dosirak">
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                    <li><img src="" alt=""></li>
                </ul>
            </div>
            <div class="swiper stepper_swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide step01">
                        <ul>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>백미밥(흰쌀밥)</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>흑미밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>잡곡밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>콩밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>현미밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>강황밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>계란볶음밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>간장계란밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>케찹계란밥</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="bap" value="">
                                    <div>김치볶음밥</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step02">
                        <ul>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>돈까스</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>치즈돈까스</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>치킨까스</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>고추장 제육볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>김치 제육볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>소 불고기</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>간장 돼지 불고기</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>떡갈비</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>닭강정</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>고등어구이</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>언양식 바싹 불고기</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>부대볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>새우튀김</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>고추장 닭갈비</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>간장찜닭</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="meban" value="">
                                    <div>함박스테이크</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step03">
                        <ul>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>계란말이</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>소시지 야채볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>미니떡갈비</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>미니돈까스</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>계란 장조림</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>동그랑땡</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>부추전</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>분홍소시지부침</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>김치전</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>두부부침</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>김말이</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>맛살볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>오뎅볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="suban" value="">
                                    <div>새우튀김</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step04">
                        <ul>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>어묵볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>감자조림</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>콩나물무침</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>건새우볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>단호박샐러드</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>콘샐러드</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>진미채</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>멸치볶음</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>양파장아찌</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>시금치나물</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>고사리나물</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>볶음김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>백김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>백김치</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>무생채</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>무말랭이</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>깍두기</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>단무지</div>
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="kimchi" value="">
                                    <div>배추김치</div>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="swiper-slide step05">
                        <div>완성</div>
                    </div>
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-pagination"></div>
            </div>
            <div class="pop_area">
                <div class="toast_pop pop01">
                    <div class="cont">
                        훌륭한 조립이예요!
                    </div>
                </div>
                <div class="toast_pop pop02">
                    <div class="cont">
                        맛있는 프로젝트7도시락 조립 중..
                    </div>
                </div>
                <div class="toast_pop pop03">
                    <div class="cont">
                        이제 거의 끝나가요
                    </div>
                </div>
                <div class="toast_pop pop04">
                    <div class="cont">
                        조금만 더 조립하면 도시락 완성!
                    </div>
                </div>
            </div>
        </section>
    </main>
</body>
<script>
    var swiper = new Swiper(".stepper_swiper", {
        touchRatio: 0,
        speed: 500,
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        pagination: {
            el: ".swiper-pagination",
            type: 'bullets',
        },
        on: {
            slideChange: function() {
                // 현재 활성화된 인덱스 가져오기
                var activeIndex = swiper.activeIndex;
                var previousIndex = swiper.previousIndex;
                // 모든 bullet 가져오기
                var bullets = document.querySelectorAll('.swiper-pagination-bullet');

                // 현재 인덱스 이전의 모든 bullet에 active 클래스 추가
                if (activeIndex > previousIndex) {
                    bullets.forEach(function(bullet, index) {
                        if (index <= activeIndex) {
                            bullet.classList.add('active');
                        }
                    });
                }
                // 뒤로 이동한 경우, 현재 인덱스 이후의 모든 bullet에서 active 클래스 제거
                if (activeIndex < previousIndex) {
                    bullets.forEach(function(bullet, index) {
                        if (index > activeIndex) {
                            bullet.classList.remove('active');
                        }
                    });
                }
            }
        },
    });

    // function activeButton() {
    // 	// step01
    // 	if($('.swiper-pagination-bullet:nth-child(1)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step01 input[type="checkbox"]:checked').length > 0) {
    // 			$('.step01 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step01 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	}
    // 	// step02
    // 	if($('.swiper-pagination-bullet:nth-child(2)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step02 input[type="checkbox"]:checked').length >= 3) {
    // 			$('.step02 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step02 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	} 
    // 	// step03
    // 	if($('.swiper-pagination-bullet:nth-child(3)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step03 input[type="checkbox"]:checked').length >= 2) {
    // 			$('.step03 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step03 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	} 
    // 	// step04
    // 	if($('.swiper-pagination-bullet:nth-child(4)').hasClass('swiper-pagination-bullet-active')){
    // 		$('.swiper-button-next').removeClass('on');
    // 		if ($('.step04 input[type="checkbox"]:checked').length >= 2) {
    // 			$('.step04 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 			$('.swiper-button-next').addClass('on');
    // 		} else {
    // 			$('.step04 input[type="checkbox"]').removeAttr('disabled');
    // 		}
    // 	} 

    // }
    // $('.step01').on('change', 'input[type="checkbox"]', activeButton(i))
    // $('.step02').on('change', 'input[type="checkbox"]', activeButton)
    // $('.step03').on('change', 'input[type="checkbox"]', activeButton)
    // $('.step04').on('change', 'input[type="checkbox"]', activeButton)
    // $('.swiper-button-next, .swiper-button-prev').on('click', activeButton)

    // step별 필요 선택 갯수
    const minChecked = {
        1: 1,
        2: 3,
        3: 2,
        4: 2
    }

    function activeButton(step) {
        // 페이지네이션 불렛으로 각 스텝에 맞게 체크
        if ($(`.swiper-pagination-bullet:nth-child(${step})`).hasClass('swiper-pagination-bullet-active')) {
            // 디폴트로 다음 버튼 비활성화
            $('.swiper-button-next').removeClass('on');
            const stepSelector = `.step0${step}`;
            const checkedLength = $(`${stepSelector} input[type="checkbox"]:checked`).length;
            // 각 step별 필요 갯수 확인 후 다음 버튼 활성화, 체크 박스 비활성화
            if (checkedLength >= minChecked[step]) {
                $(`${stepSelector} input[type="checkbox"]`).not(':checked').attr('disabled', true);
                $('.swiper-button-next').addClass('on');
            } else {
                $(`${stepSelector} input[type="checkbox"]`).removeAttr('disabled');
            }
        }
    }
    // 랜덤 팝업
    function toastPop(step) {
        var randomPop;

        if (step <= 3) {
            randomPop = Math.random() < 0.5 ? '.toast_pop.pop01' : '.toast_pop.pop02';
        } else {
            var pops = ['.toast_pop.pop01', '.toast_pop.pop02', '.toast_pop.pop03', '.toast_pop.pop04'];
            var randomPop = pops[Math.floor(Math.random() * pops.length)];
        }
        $(randomPop).show();
        setTimeout(function() {
            $(randomPop).hide();
        }, 1000)
    }

    function updateDosirakImage(step) {
        // 각 스텝별로 처리
        $(`.step0${step} li input[type="checkbox"]`).on('change', function() {
            // 체크된 체크박스의 부모 li 인덱스를 가져오기
            let checkedIndex = $(this).closest('li').index() + 1;
            // 각 스텝에 맞는 이미지 경로 설정
            let imgSrc;
            if (step === 1) {
                if (this.checked) {
                    imgSrc = `../../../assets/img/bap0${checkedIndex}.png`;
                } else {
                    imgSrc = '';
                }
                $(`.dosirak li:nth-child(1) img`).attr('src', imgSrc); // 첫 번째 li에 이미지 변경
            } else if (step === 2) {
                if (this.checked) {
                    imgSrc = `../../../assets/img/meban0${checkedIndex}.png`;

                    if (!$('.dosirak li:nth-child(2) img').attr('src')) {
                        $('.dosirak li:nth-child(2) img').attr('src', imgSrc);
                    } else if (!$('.dosirak li:nth-child(3) img').attr('src')) {
                        $('.dosirak li:nth-child(3) img').attr('src', imgSrc);
                    } else if (!$('.dosirak li:nth-child(4) img').attr('src')) {
                        $('.dosirak li:nth-child(4) img').attr('src', imgSrc);
                    }
                } else {
                    // 뒤에서부터 순차적으로 이미지 제거 (4 -> 3 -> 2 번째 li)
                    if ($('.dosirak li:nth-child(4) img').attr('src') === `../../../assets/img/meban0${checkedIndex}.png`) {
                        $(`.dosirak li:nth-child(4) img`).attr('src', '');
                    } else if ($('.dosirak li:nth-child(3) img').attr('src') === `../../../assets/img/meban0${checkedIndex}.png`) {
                        $(`.dosirak li:nth-child(3) img`).attr('src', '');
                    } else if ($('.dosirak li:nth-child(2) img').attr('src') === `../../../assets/img/meban0${checkedIndex}.png`) {
                        $(`.dosirak li:nth-child(2) img`).attr('src', '');
                    }
                }
            } else if (step === 3) {
                if (this.checked) {
                    imgSrc = `../../../assets/img/suban0${checkedIndex}.png`;

                    if (!$('.dosirak li:nth-child(5) img').attr('src')) {
                        $('.dosirak li:nth-child(5) img').attr('src', imgSrc);
                    } else if (!$('.dosirak li:nth-child(6) img').attr('src')) {
                        $('.dosirak li:nth-child(6) img').attr('src', imgSrc);
                    }
                } else {
                    if ($(`.dosirak li:nth-child(6) img`).attr('src') === `../../../assets/img/suban0${checkedIndex}.png`) {
                        $(`.dosirak li:nth-child(6) img`).attr('src', '');
                    } else if ($(`.dosirak li:nth-child(5) img`).attr('src') === `../../../assets/img/suban0${checkedIndex}.png`) {
                        $(`.dosirak li:nth-child(5) img`).attr('src', '');
                    }
                }

            }
        });
    }
    // 스텝별 checkbox 변화에 따라 갱신
    for (let i = 1; i <= 4; i++) {
        updateDosirakImage(i);
        $(`.step0${i}`).on('change', 'input[type="checkbox"]', function() {
            activeButton(i);
        });
    }
    // swiper 이전, 다음 버튼 클릭 시 모든 step 상태 갱신
    $('.swiper-button-next, .swiper-button-prev').on('click', function() {
        for (let i = 1; i <= 4; i++) {
            activeButton(i);
        }
    });
    $('.swiper-button-next').on('click', function() {
        const currentStep = swiper.activeIndex + 1;
        toastPop(currentStep)
    })

    // 이전 버튼 클릭 시 다음 버튼 활성화
    // $('.swiper-button-prev').on('click', function() {
    // 	$('.swiper-button-next').removeClass('off');
    // });
    //  // 다음 버튼 클릭 시 다음 버튼 비활성화
    // $('.swiper-button-next').on('click', function() {
    // 	$(this).addClass('off')
    // });
    // 스텝02 체크박스 갯수 제한
    // $('.step02').on('change', 'input[type="checkbox"]', function() {
    // 	if ($('.step02 input[type="checkbox"]:checked').length >= 3) {
    // 		$('.step02 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 		// 선택 갯수 충족 시 다음 버튼 활성화
    // 		$('.swiper-button-next').removeClass('off');
    // 	} else {
    // 		$('.step02 input[type="checkbox"]').removeAttr('disabled');
    // 		$('.swiper-button-next').addClass('off');
    // 	}
    // });
    // 스텝03 체크박스 갯수 제한
    // $('.step03').on('change', 'input[type="checkbox"]', function() {
    // 	if ($('.step03 input[type="checkbox"]:checked').length >= 2) {
    // 		$('.step03 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 		$('.swiper-button-next').removeClass('off');
    // 	} else {
    // 		$('.step03 input[type="checkbox"]').removeAttr('disabled');
    // 		$('.swiper-button-next').addClass('off');
    // 	}
    // });
    // 스텝04 체크박스 갯수 제한
    // $('.step04').on('change', 'input[type="checkbox"]', function() {
    // 	if ($('.step04 input[type="checkbox"]:checked').length >= 2) {
    // 		$('.step04 input[type="checkbox"]').not(':checked').attr('disabled', true);
    // 		$('.swiper-button-next').removeClass('off');
    // 	} else {
    // 		$('.step04 input[type="checkbox"]').removeAttr('disabled');
    // 		$('.swiper-button-next').addClass('off');
    // 	}
    // });
</script>

</html>